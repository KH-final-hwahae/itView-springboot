<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="itView.springboot.mapper.AdminMapper">
<!-- 회원조회 Id -->
<select id="searchUserById">
select * from "USER" where user_id = #{userId}
</select>

<!-- 회원조회 type -->
<select id="searchUserByType">
select * from "USER" where user_type = #{userType}
</select>

<!-- 회원조회 status -->
<select id="searchUserByStatus">
select * from "USER" where user_status = #{userStatus}
</select>

<!-- 회원조회 report -->
<select id="searchUserByReport"  resultType="itView.springboot.dto.ReportDto">
select
    r.REPORT_NO,
    r.REPORT_TITLE,
    r.REPORT_CONTENT,
    r.REPORT_DATE,
    r.REPORT_MODIFY_DATE,
    r.REPORT_STATUS,
    r.REPORT_TYPE,
    r.REPORTER_USER_ID,
    r.REPORT_TARGET_NO,
    u.USER_ID AS targetUserId,
    target_report_count.reportCount
FROM REPORT r
JOIN "USER" u
    ON r.REPORT_TARGET_NO = u.USER_NO
JOIN (
    SELECT REPORT_TARGET_NO, COUNT(*) AS reportCount
    FROM REPORT
    GROUP BY REPORT_TARGET_NO
) target_report_count
    ON r.REPORT_TARGET_NO = target_report_count.REPORT_TARGET_NO
ORDER BY r.REPORT_TARGET_NO, r.REPORT_NO;
</select>


<!-- 회원조회  전체 -->
<select id="getAllUser">
select * from "USER"
</select>




















</mapper>